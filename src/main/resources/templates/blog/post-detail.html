<!DOCTYPE html>
<html lang="ko"
      xmlns:th="http://www.thymeleaf.org"
      data-font-size="M"
      data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <!-- 페이지 제목 -->
    <title th:text="${pageTitle} ?: 'HOT GAMJA LAB'">포스트 제목 - HOT GAMJA LAB</title>

    <!-- 메타 태그 (SEO) -->
    <meta name="description" th:content="${post.description}">
    <meta name="author" content="HOT GAMJA">

    <!-- CSS 파일들 -->
    <link rel="stylesheet" th:href="@{/css/blog-base.css}">
    <link rel="stylesheet" th:href="@{/css/blog-layout.css}">
    <link rel="stylesheet" th:href="@{/css/blog-post.css}">
    <link rel="stylesheet" th:href="@{/css/blog-responsive.css}">
</head>
<body>
    <!--
        포스트 상세 페이지

        Controller에서 전달받는 데이터:
        - post: 현재 보고 있는 포스트 (Post 객체)
        - relatedPosts: 관련 포스트 목록 (List<Post>, 최대 3개)
    -->

    <!-- 전체 컨테이너 -->
    <div class="blog-container">
        <!-- About 패널 (post 객체를 넘겨서 "홈으로" 버튼 표시) -->
        <div th:replace="~{blog-fragments/about :: about-panel}"></div>

        <!-- Brand Background -->
        <div th:replace="~{blog-fragments/brand-background :: brand-bg}"></div>

        <!-- 메인 콘텐츠 영역 -->
        <main class="main-content">
            <div class="content-wrapper">
                <!-- 포스트 상세 영역 -->
                <article class="post-detail">
                    <!-- 포스트 헤더 -->
                    <header class="post-header">
                        <!-- 카테고리 배지 -->
                        <div class="post-category-wrapper">
                            <a th:href="@{/categories/{category}(category=${post.category})}"
                               class="category-badge"
                               th:text="${post.category}">
                                SPRING
                            </a>
                        </div>

                        <!-- 제목 (H1) -->
                        <h1 class="post-detail-title" th:text="${post.title}">
                            Spring Boot와 Docker로 로컬 개발 환경 구축하기
                        </h1>

                        <!-- 메타 정보: 날짜 및 태그 -->
                        <div class="post-detail-meta">
                            <!-- 작성 날짜 -->
                            <time class="post-date"
                                  th:datetime="${post.date}"
                                  th:text="${#temporals.format(post.date, 'yyyy년 MM월 dd일')}">
                                2025년 01월 15일
                            </time>

                            <!-- 태그 리스트 -->
                            <div class="post-tags" th:if="${post.tags != null and !post.tags.isEmpty()}">
                                <a th:each="tag : ${post.tags}"
                                   th:href="@{/tags/{tag}(tag=${tag})}"
                                   class="tag"
                                   th:text="'#' + ${tag}">
                                    #Docker
                                </a>
                            </div>
                        </div>
                    </header>

                    <!--
                        대표 이미지 (썸네일, 있을 경우만 표시)
                        현재 더미 데이터에는 없지만 나중을 위해 준비
                    -->
                    <div class="post-featured-image" th:if="${post.thumbnailUrl != null}">
                        <img th:src="${post.thumbnailUrl}"
                             th:alt="${post.title}"
                             loading="lazy">
                    </div>

                    <!--
                        포스트 본문

                        th:utext="${post.content}"
                        - utext: HTML 태그를 그대로 렌더링 (이스케이프 안 함)
                        - text: HTML 태그를 문자열로 표시 (이스케이프)

                        주의:
                        - 사용자 입력을 utext로 출력하면 XSS 위험
                        - 현재는 더미 데이터(신뢰된 콘텐츠)이므로 utext 사용
                        - 실제 서비스에서는 HTML sanitizer 사용 권장
                    -->
                    <div class="post-content" th:utext="${post.content}">
                        <h2>들어가며</h2>
                        <p>본문 내용이 여기에 표시됩니다...</p>
                    </div>

                    <!-- 포스트 하단: 요약 섹션 -->
                    <footer class="post-footer">
                        <!-- 요약 (Summary) -->
                        <div class="post-summary" th:if="${post.summary != null}">
                            <h3 class="summary-title">요약</h3>
                            <p class="summary-content" th:text="${post.summary}">
                                이 글에서는 Docker Compose로 Spring Boot 앱을 실행하고,
                                PostgreSQL과 연동하는 방법을 다뤘습니다.
                            </p>
                        </div>

                        <!-- 피드백 안내 -->
                        <div class="post-feedback">
                            <h3 class="feedback-title">피드백</h3>
                            <p class="feedback-content">
                                글에 오류가 있거나 개선할 점이 있다면
                                <a href="https://github.com/hot-gamja/issues" target="_blank" rel="noopener noreferrer">GitHub Issue</a>나
                                <a href="mailto:hotgamja@example.com">이메일</a>로 알려주세요!
                            </p>
                        </div>
                    </footer>
                </article>

                <!--
                    관련 포스트 섹션
                    (같은 카테고리의 다른 글, 최대 3개)
                -->
                <section class="related-posts"
                         th:if="${relatedPosts != null and !relatedPosts.isEmpty()}">
                    <h2 class="related-title">관련 포스트</h2>

                    <div class="related-list">
                        <!--
                            관련 포스트 카드 반복
                            index.html의 post-card와 동일한 구조
                        -->
                        <article th:each="related : ${relatedPosts}" class="post-card related-card">
                            <a th:href="@{/posts/{slug}(slug=${related.slug})}" class="post-card-link">
                                <!-- 카테고리 -->
                                <div class="post-category">
                                    <span class="category-badge" th:text="${related.category}">SPRING</span>
                                </div>

                                <!-- 제목 -->
                                <h3 class="post-title" th:text="${related.title}">
                                    PostgreSQL을 Docker로 띄우고 Spring Boot와 연동하기
                                </h3>

                                <!-- 설명 -->
                                <p class="post-description" th:text="${related.description}">
                                    Docker로 PostgreSQL을 실행하고 Spring Data JPA와 연결하는 방법을 정리합니다.
                                </p>

                                <!-- 메타 정보 -->
                                <div class="post-meta">
                                    <time class="post-date"
                                          th:datetime="${related.date}"
                                          th:text="${#temporals.format(related.date, 'yyyy.MM.dd')}">
                                        2025.01.20
                                    </time>
                                </div>
                            </a>
                        </article>
                    </div>
                </section>
            </div>
        </main>

        <!-- Reader Controls -->
        <div th:replace="~{blog-fragments/reader-controls :: controls}"></div>
    </div>

    <!-- JavaScript -->
    <script th:src="@{/js/reader-controls.js}"></script>
    <script th:src="@{/js/scroll-horizontal.js}"></script>

    <!--
        설명:

        1. th:utext vs th:text:
           - utext: HTML을 그대로 렌더링 (본문 내용)
           - text: HTML을 문자열로 표시 (제목, 설명 등)

        2. 관련 포스트:
           - Controller에서 같은 카테고리의 글 3개 전달
           - 없으면 섹션 전체가 숨겨짐 (th:if)

        3. 링크:
           - 카테고리 클릭 -> /categories/SPRING
           - 태그 클릭 -> /tags/Docker
           - 관련 포스트 클릭 -> /posts/{slug}

        4. 포스트 구조:
           - Header: 카테고리, 제목, 날짜, 태그
           - Content: 본문 (HTML)
           - Footer: 요약, 피드백 안내
           - Related: 관련 포스트 (선택)

        5. dayloog 스타일:
           - 넓은 여백, 큰 폰트, 읽기 편한 레이아웃
           - 코드 블록 강조
           - 다크 테마 기본
    -->
</body>
</html>
